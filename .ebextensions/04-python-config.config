# Python and Application Configuration
option_settings:
  # Python WSGI Configuration
  aws:elasticbeanstalk:container:python:
    WSGIPath: application:application
    NumProcesses: 2
    NumThreads: 15
    
  # Environment Variables
  aws:elasticbeanstalk:application:environment:
    PYTHONPATH: "/var/app/current:$PYTHONPATH"
    FLASK_APP: "application.py"
    FLASK_ENV: "production"
    
  # Auto Scaling (Single Instance)
  aws:autoscaling:launchconfiguration:
    DisableIMDSv1: true
    InstanceType: t3.medium
    
  # Load Balancer (Disabled for single instance)
  aws:elasticbeanstalk:environment:
    EnvironmentType: SingleInstance
    
  # Monitoring
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced
    
  # Log Files
  aws:elasticbeanstalk:hostmanager:
    LogPublicationControl: true

# Install Python dependencies
commands:
  01_install_python_deps:
    command: |
      # Install additional Python packages for media processing
      /var/app/venv/*/bin/pip install --upgrade pip
      /var/app/venv/*/bin/pip install ffmpeg-python
    ignoreErrors: true
